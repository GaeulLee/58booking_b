<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="goodee.gdj58.booking_c.mapper.gaeul.BookingMapper2">
	
	<!-- 예약 상태 별 건수(신규, 확정, 완료, 환불) -->
	<select id="selectBookingCnt"
			resultType="Integer"
			parameterType="goodee.gdj58.booking_c.vo.Booking">
		SELECT COUNT(*) cnt
		FROM booking
		WHERE booking_company_id = #{companyId} AND booking_state = #{bookingState} 
	</select>
	<!-- 
		SELECT b.booking_state
		      , (SELECT COUNT(*)
						FROM booking
					WHERE booking_company_id = 'com1' AND b.booking_state = booking_state) 건수
		FROM booking b
		GROUP BY booking_state;
	 -->
	 
	 <!-- 예약 건수 리스트(인기상품순위) -->
	 <select id="selectProductLsitByBooking"
	 		 parameterType="java.lang.String"
	 		 resultType="java.util.HashMap">
	 	SELECT
			bp.booking_product_name productName
			, COUNT(bp.booking_product_name) cnt
		FROM booking b
			INNER JOIN booking_product bp
			ON b.product_no = bp.booking_product_no
		WHERE b.booking_company_id = #{companyId}
		GROUP BY bp.booking_product_name
		ORDER BY cnt DESC
		LIMIT 0, 5
	 </select>
</mapper>